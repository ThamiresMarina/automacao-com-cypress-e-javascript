"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ProblemType = exports.NON_REPORTABLE_STATUSES = exports.ORDERED_STATUSES = exports.ERROR_INDENT_LENGTH = exports.ATTACHMENT_INDENT_LENGTH = exports.STEP_ARGUMENT_INDENT_LENGTH = exports.GHERKIN_INDENT_LENGTH = void 0;
exports.ensure = ensure;
exports.join = join;
exports.indent = indent;
exports.indentNumbered = indentNumbered;
exports.pad = pad;
exports.unstyled = unstyled;
exports.extractReportableMessage = extractReportableMessage;
const node_util_1 = require("node:util");
const messages_1 = require("@cucumber/messages");
exports.GHERKIN_INDENT_LENGTH = 2;
exports.STEP_ARGUMENT_INDENT_LENGTH = 2;
exports.ATTACHMENT_INDENT_LENGTH = 4;
exports.ERROR_INDENT_LENGTH = 4;
exports.ORDERED_STATUSES = [
    messages_1.TestStepResultStatus.UNKNOWN,
    messages_1.TestStepResultStatus.PASSED,
    messages_1.TestStepResultStatus.SKIPPED,
    messages_1.TestStepResultStatus.PENDING,
    messages_1.TestStepResultStatus.UNDEFINED,
    messages_1.TestStepResultStatus.AMBIGUOUS,
    messages_1.TestStepResultStatus.FAILED,
];
exports.NON_REPORTABLE_STATUSES = [messages_1.TestStepResultStatus.PASSED, messages_1.TestStepResultStatus.SKIPPED];
var ProblemType;
(function (ProblemType) {
    ProblemType[ProblemType["PARAMETER_TYPE"] = 0] = "PARAMETER_TYPE";
    ProblemType[ProblemType["GLOBAL_HOOK"] = 1] = "GLOBAL_HOOK";
    ProblemType[ProblemType["TEST_CASE"] = 2] = "TEST_CASE";
    ProblemType[ProblemType["TEST_RUN"] = 3] = "TEST_RUN";
})(ProblemType || (exports.ProblemType = ProblemType = {}));
function ensure(value, message) {
    if (!value) {
        throw new Error(message);
    }
    return value;
}
function join(...originals) {
    return originals.filter((part) => !!part).join(' ');
}
function indent(original, by) {
    return original
        .split('\n')
        .map((line) => ' '.repeat(by) + line)
        .join('\n');
}
function indentNumbered(original, by, number) {
    const baselineIndent = ' '.repeat(by);
    return original
        .split('\n')
        .map((line, i) => {
        if (line === '') {
            return '';
        }
        return i === 0 ? `${baselineIndent}${number}) ${line}` : `${baselineIndent}   ${line}`;
    })
        .join('\n');
}
function pad(original) {
    return `\n` + original + '\n';
}
function unstyled(text) {
    return (0, node_util_1.stripVTControlCharacters)(text);
}
function extractReportableMessage(testStepResult) {
    const { status, exception, message: standaloneMessage } = testStepResult;
    if (status === messages_1.TestStepResultStatus.FAILED) {
        return exception?.stackTrace || exception?.message || standaloneMessage;
    }
    if (status === messages_1.TestStepResultStatus.PENDING || status === messages_1.TestStepResultStatus.SKIPPED) {
        return exception?.message || standaloneMessage;
    }
    return undefined;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBeUJBLHdCQUtDO0FBRUQsb0JBRUM7QUFFRCx3QkFLQztBQUVELHdDQVdDO0FBRUQsa0JBRUM7QUFFRCw0QkFFQztBQUVELDREQVlDO0FBNUVELHlDQUFvRDtBQUVwRCxpREFBeUU7QUFFNUQsUUFBQSxxQkFBcUIsR0FBRyxDQUFDLENBQUE7QUFDekIsUUFBQSwyQkFBMkIsR0FBRyxDQUFDLENBQUE7QUFDL0IsUUFBQSx3QkFBd0IsR0FBRyxDQUFDLENBQUE7QUFDNUIsUUFBQSxtQkFBbUIsR0FBRyxDQUFDLENBQUE7QUFDdkIsUUFBQSxnQkFBZ0IsR0FBMkI7SUFDdEQsK0JBQW9CLENBQUMsT0FBTztJQUM1QiwrQkFBb0IsQ0FBQyxNQUFNO0lBQzNCLCtCQUFvQixDQUFDLE9BQU87SUFDNUIsK0JBQW9CLENBQUMsT0FBTztJQUM1QiwrQkFBb0IsQ0FBQyxTQUFTO0lBQzlCLCtCQUFvQixDQUFDLFNBQVM7SUFDOUIsK0JBQW9CLENBQUMsTUFBTTtDQUM1QixDQUFBO0FBQ1ksUUFBQSx1QkFBdUIsR0FBRyxDQUFDLCtCQUFvQixDQUFDLE1BQU0sRUFBRSwrQkFBb0IsQ0FBQyxPQUFPLENBQUMsQ0FBQTtBQUNsRyxJQUFZLFdBS1g7QUFMRCxXQUFZLFdBQVc7SUFDckIsaUVBQWMsQ0FBQTtJQUNkLDJEQUFXLENBQUE7SUFDWCx1REFBUyxDQUFBO0lBQ1QscURBQVEsQ0FBQTtBQUNWLENBQUMsRUFMVyxXQUFXLDJCQUFYLFdBQVcsUUFLdEI7QUFFRCxTQUFnQixNQUFNLENBQUksS0FBb0IsRUFBRSxPQUFlO0lBQzdELElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNYLE1BQU0sSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDMUIsQ0FBQztJQUNELE9BQU8sS0FBSyxDQUFBO0FBQ2QsQ0FBQztBQUVELFNBQWdCLElBQUksQ0FBQyxHQUFHLFNBQTRDO0lBQ2xFLE9BQU8sU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQTtBQUNyRCxDQUFDO0FBRUQsU0FBZ0IsTUFBTSxDQUFDLFFBQWdCLEVBQUUsRUFBVTtJQUNqRCxPQUFPLFFBQVE7U0FDWixLQUFLLENBQUMsSUFBSSxDQUFDO1NBQ1gsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQztTQUNwQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7QUFDZixDQUFDO0FBRUQsU0FBZ0IsY0FBYyxDQUFDLFFBQWdCLEVBQUUsRUFBVSxFQUFFLE1BQWM7SUFDekUsTUFBTSxjQUFjLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQTtJQUNyQyxPQUFPLFFBQVE7U0FDWixLQUFLLENBQUMsSUFBSSxDQUFDO1NBQ1gsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQ2YsSUFBSSxJQUFJLEtBQUssRUFBRSxFQUFFLENBQUM7WUFDaEIsT0FBTyxFQUFFLENBQUE7UUFDWCxDQUFDO1FBQ0QsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLGNBQWMsR0FBRyxNQUFNLEtBQUssSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsY0FBYyxNQUFNLElBQUksRUFBRSxDQUFBO0lBQ3hGLENBQUMsQ0FBQztTQUNELElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQTtBQUNmLENBQUM7QUFFRCxTQUFnQixHQUFHLENBQUMsUUFBZ0I7SUFDbEMsT0FBTyxJQUFJLEdBQUcsUUFBUSxHQUFHLElBQUksQ0FBQTtBQUMvQixDQUFDO0FBRUQsU0FBZ0IsUUFBUSxDQUFDLElBQVk7SUFDbkMsT0FBTyxJQUFBLG9DQUF3QixFQUFDLElBQUksQ0FBQyxDQUFBO0FBQ3ZDLENBQUM7QUFFRCxTQUFnQix3QkFBd0IsQ0FBQyxjQUE4QjtJQUNyRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsR0FBRyxjQUFjLENBQUE7SUFFeEUsSUFBSSxNQUFNLEtBQUssK0JBQW9CLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDM0MsT0FBTyxTQUFTLEVBQUUsVUFBVSxJQUFJLFNBQVMsRUFBRSxPQUFPLElBQUksaUJBQWlCLENBQUE7SUFDekUsQ0FBQztJQUVELElBQUksTUFBTSxLQUFLLCtCQUFvQixDQUFDLE9BQU8sSUFBSSxNQUFNLEtBQUssK0JBQW9CLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDdkYsT0FBTyxTQUFTLEVBQUUsT0FBTyxJQUFJLGlCQUFpQixDQUFBO0lBQ2hELENBQUM7SUFFRCxPQUFPLFNBQVMsQ0FBQTtBQUNsQixDQUFDIn0=